CODES	SEGMENT `CODE'
	ASSUME CS:CODES
	ORG 5DH
	
CUENTA  DW	?
	ORG	100H

INICIO: 
	JMP     PPAL

ADDR1	DD	?
SEC10	DB	182
ACTIVO	DB	0

ALARMA	EQU	10
TONO	EQU	800
LONG	EQU	6

BIP	PROC	NEAR
	PUSH AX
	PUSH BX
	PUSH CX
	PUSH DX
	PUSH ES
	MOV AL, 0B6H
	OUT 43H,AL
	
	MOV DX,12H
	MOV AX,34DCH
	MOV BX,TONO
	DIV BX
	
	OUT 42H,AL
	MOV AL,AH
	OUT 42H,AL
	
	IN AL,61H
	OR AL,3
	OUT 61H,AL
	MOV DX, LONG
	SUB CX,CX
	MOV ES,CX
	ADD DX,ES:[46CH]
	ADC CX,ES:[46EH]

BEEPS:
	MOV BX,ES:[64CH]
	MOV AX,ES:[46EH]
	SUB BX,DX
	SBB AX,CX
	JC BEEPS
	IN AL,61H
	XOR AL,3
	OUT 61H,AL
	
	POP ES
	POP DX
	POP CX
	POP BX
	POP AX
	RET
	
BIP ENDP

TIMES 	PROC 	FAR

	CMP ACTIVO,0
	JZ TIMES1
	JMP ADDR1
TIMES1:	INC ACTIVO
	PUSHF
	CALL ADDR1
	STI
	PUSH DS
	PUSH CS
	POP DS
	DEC SEC10
	JNZ TIMES2
	MOV SEC10,182
	
	DEC CUENTA
	JNZ TIMES2
	CALL BIP
	INC ACTIVO
	
TIMES2:
	DEC ACTIVO
	POP DS
	IRET
	
TIMES ENDP

PPAL:
	MOV AX,ALARMA
	MOV CUENTA,AX
	MOV AX,3508H
	INT 21H
	MOV WORD PTR ADDR1,BX
	MOV WORD PTR ADDR1+2,ES
	MOV AX,2508H
	MOV DX,OFFSET TIMES
	INT 21H
	MOV DX,OFFSET PPAL
	MOV CL,4
	SHR DX,CL
	INC DX
	MOV AX,3100H
	INT 21

CODES ENDS
	
	END INICIO